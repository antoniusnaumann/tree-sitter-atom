==================
Function definitions
==================

+add(a Int, b Int) Int {
    a + b
}

---

(source_file
  (function_definition
    (visibility)
    (identifier)
    (parameter
      (identifier)
      (primitive_type))
    (parameter
      (identifier)
      (primitive_type))
    (return_type
      (primitive_type))
    (block
      (binary_expression
        (identifier)
        (identifier)))))

==================
Struct definition
==================

+Point(x Float, y Float)

---

(source_file
  (struct_definition
    (visibility)
    (identifier)
    (struct_field
      (identifier)
      (primitive_type))
    (struct_field
      (identifier)
      (primitive_type))))

==================
Enum definition
==================

+Result(t, e = String;
    Ok(t)
    Err(e)
)

---

(source_file
  (enum_definition
    (visibility)
    (identifier)
    (type_parameter
      (primitive_type)
      (identifier)
      (primitive_type))
    (enum_case
      (identifier)
      (type))
    (enum_case
      (identifier)
      (type))))

==================
Variable declaration
==================

main() {
    p := Point(x: 1.0, y: 2.0)
    result := add(1, 2)
}

---

(source_file
  (function_definition
    (identifier)
    (block
      (variable_declaration
        (identifier)
        (struct_expression
          (identifier)
          (struct_field_init
            (identifier)
            (number_literal))
          (struct_field_init
            (identifier)
            (number_literal))))
      (variable_declaration
        (identifier)
        (call_expression
          (identifier)
          (number_literal)
          (number_literal))))))

==================
Match statement
==================

fib(n Int) Int {
    match(n) {
        0 { 0 }
        1 { 1 }
        _ { fib(n - 1) + fib(n - 2) }
    }
}

---

(source_file
  (function_definition
    (identifier)
    (parameter
      (identifier)
      (primitive_type))
    (return_type
      (primitive_type))
    (block
      (match_statement
        (identifier)
        (match_arm
          (pattern
            (number_literal))
          (block
            (number_literal)))
        (match_arm
          (pattern
            (number_literal))
          (block
            (number_literal)))
        (match_arm
          (pattern)
          (block
            (binary_expression
              (call_expression
                (identifier)
                (binary_expression
                  (identifier)
                  (number_literal)))
              (call_expression
                (identifier)
                (binary_expression
                  (identifier)
                  (number_literal))))))))))

==================
Loop statement
==================

sum(values Int*) Int {
    total := 0
    loop(values) {
        total += $0
    }
    total
}

---

(source_file
  (function_definition
    (identifier)
    (parameter
      (identifier)
      (variadic_type
        (primitive_type)))
    (return_type
      (primitive_type))
    (block
      (variable_declaration
        (identifier)
        (number_literal))
      (loop_statement
        (identifier)
        (block
          (assignment_expression
            (identifier)
            (identifier))))
      (identifier))))

==================
Test block
==================

"Basic arithmetic" {
    assert(add(2, 3) == 5)
}

---

(source_file
  (test_block
    (string_literal)
    (block
      (call_expression
        (identifier)
        (binary_expression
          (call_expression
            (identifier)
            (number_literal)
            (number_literal))
          (number_literal))))))

==================
Comments
==================

/// This is a doc comment
// This is a regular comment
+func() {}

---

(source_file
  (comment)
  (comment)
  (function_definition
    (visibility)
    (identifier)
    (block)))

==================
String interpolation
==================

greet(name String) String {
    "Hello, \(name)!"
}

---

(source_file
  (function_definition
    (identifier)
    (parameter
      (identifier)
      (primitive_type))
    (return_type
      (primitive_type))
    (block
      (interpolation
        (string_literal)
        (identifier)
        (string_literal)))))

==================
Generic function
==================

+unwrap(op Option(t), msg String = "default") t {
    match(op) {
        Some(inner) { inner }
        None { error(msg) }
    }
}

---

(source_file
  (function_definition
    (visibility)
    (identifier)
    (parameter
      (identifier)
      (generic_type
        (identifier)
        (type_parameter
          (identifier))))
    (parameter
      (identifier)
      (primitive_type)
      (string_literal))
    (return_type
      (identifier))
    (block
      (match_statement
        (identifier)
        (match_arm
          (pattern
            (identifier)
            (pattern
              (identifier)))
          (block
            (identifier)))
        (match_arm
          (pattern
            (identifier))
          (block
            (call_expression
              (identifier)
              (identifier))))))))